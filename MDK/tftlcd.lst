C51 COMPILER V9.60.0.0   TFTLCD                                                            01/08/2021 19:05:39 PAGE 1   


C51 COMPILER V9.60.0.0, COMPILATION OF MODULE TFTLCD
OBJECT MODULE PLACED IN .\Out_File\tftlcd.obj
COMPILER INVOKED BY: D:\Keil_v5\C51\BIN\C51.EXE ..\Device\tftlcd.c LARGE OPTIMIZE(8,SPEED) BROWSE INCDIR(..\Device;..\Li
                    -braries;..\User) DEBUG OBJECTEXTEND PRINT(.\tftlcd.lst) OBJECT(.\Out_File\tftlcd.obj)

line level    source

   1          #include "tftlcd.h"
   2          
   3          code const uint8 asc2_1206[95][12]={
   4          {0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00},/*" ",0*/
   5          {0x00,0x00,0x04,0x04,0x04,0x04,0x04,0x04,0x00,0x04,0x00,0x00},/*"!",1*/
   6          {0x00,0x14,0x0A,0x0A,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00},/*""",2*/
   7          {0x00,0x00,0x14,0x14,0x3F,0x14,0x0A,0x3F,0x0A,0x0A,0x00,0x00},/*"#",3*/
   8          {0x00,0x04,0x1E,0x15,0x05,0x06,0x0C,0x14,0x15,0x0F,0x04,0x00},/*"$",4*/
   9          {0x00,0x00,0x12,0x15,0x0D,0x0A,0x14,0x2C,0x2A,0x12,0x00,0x00},/*"%",5*/
  10          {0x00,0x00,0x04,0x0A,0x0A,0x1E,0x15,0x15,0x09,0x36,0x00,0x00},/*"&",6*/
  11          {0x00,0x02,0x02,0x01,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00},/*"'",7*/
  12          {0x00,0x20,0x10,0x08,0x08,0x08,0x08,0x08,0x08,0x10,0x20,0x00},/*"(",8*/
  13          {0x00,0x02,0x04,0x08,0x08,0x08,0x08,0x08,0x08,0x04,0x02,0x00},/*")",9*/
  14          {0x00,0x00,0x00,0x04,0x15,0x0E,0x0E,0x15,0x04,0x00,0x00,0x00},/*"*",10*/
  15          {0x00,0x00,0x04,0x04,0x04,0x1F,0x04,0x04,0x04,0x00,0x00,0x00},/*"+",11*/
  16          {0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x02,0x02,0x01},/*",",12*/
  17          {0x00,0x00,0x00,0x00,0x00,0x1F,0x00,0x00,0x00,0x00,0x00,0x00},/*"-",13*/
  18          {0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x02,0x00,0x00},/*".",14*/
  19          {0x00,0x10,0x08,0x08,0x08,0x04,0x04,0x02,0x02,0x02,0x01,0x00},/*"/",15*/
  20          {0x00,0x00,0x0E,0x11,0x11,0x11,0x11,0x11,0x11,0x0E,0x00,0x00},/*"0",16*/
  21          {0x00,0x00,0x04,0x06,0x04,0x04,0x04,0x04,0x04,0x0E,0x00,0x00},/*"1",17*/
  22          {0x00,0x00,0x0E,0x11,0x11,0x08,0x04,0x02,0x01,0x1F,0x00,0x00},/*"2",18*/
  23          {0x00,0x00,0x0E,0x11,0x10,0x0C,0x10,0x10,0x11,0x0E,0x00,0x00},/*"3",19*/
  24          {0x00,0x00,0x08,0x0C,0x0A,0x0A,0x09,0x1E,0x08,0x18,0x00,0x00},/*"4",20*/
  25          {0x00,0x00,0x1F,0x01,0x01,0x0F,0x10,0x10,0x11,0x0E,0x00,0x00},/*"5",21*/
  26          {0x00,0x00,0x0E,0x09,0x01,0x0F,0x11,0x11,0x11,0x0E,0x00,0x00},/*"6",22*/
  27          {0x00,0x00,0x1F,0x09,0x08,0x04,0x04,0x04,0x04,0x04,0x00,0x00},/*"7",23*/
  28          {0x00,0x00,0x0E,0x11,0x11,0x0E,0x11,0x11,0x11,0x0E,0x00,0x00},/*"8",24*/
  29          {0x00,0x00,0x0E,0x11,0x11,0x11,0x1E,0x10,0x12,0x0E,0x00,0x00},/*"9",25*/
  30          {0x00,0x00,0x00,0x00,0x04,0x00,0x00,0x00,0x00,0x04,0x00,0x00},/*":",26*/
  31          {0x00,0x00,0x00,0x00,0x00,0x04,0x00,0x00,0x00,0x04,0x04,0x00},/*";",27*/
  32          {0x00,0x20,0x10,0x08,0x04,0x02,0x04,0x08,0x10,0x20,0x00,0x00},/*"<",28*/
  33          {0x00,0x00,0x00,0x00,0x1F,0x00,0x00,0x1F,0x00,0x00,0x00,0x00},/*"=",29*/
  34          {0x00,0x02,0x04,0x08,0x10,0x20,0x10,0x08,0x04,0x02,0x00,0x00},/*">",30*/
  35          {0x00,0x00,0x0E,0x11,0x11,0x08,0x04,0x04,0x00,0x04,0x00,0x00},/*"?",31*/
  36          {0x00,0x00,0x0E,0x11,0x19,0x15,0x15,0x1D,0x01,0x1E,0x00,0x00},/*"@",32*/
  37          {0x00,0x00,0x04,0x04,0x0C,0x0A,0x0A,0x1E,0x12,0x33,0x00,0x00},/*"A",33*/
  38          {0x00,0x00,0x0F,0x12,0x12,0x0E,0x12,0x12,0x12,0x0F,0x00,0x00},/*"B",34*/
  39          {0x00,0x00,0x1E,0x11,0x01,0x01,0x01,0x01,0x11,0x0E,0x00,0x00},/*"C",35*/
  40          {0x00,0x00,0x0F,0x12,0x12,0x12,0x12,0x12,0x12,0x0F,0x00,0x00},/*"D",36*/
  41          {0x00,0x00,0x1F,0x12,0x0A,0x0E,0x0A,0x02,0x12,0x1F,0x00,0x00},/*"E",37*/
  42          {0x00,0x00,0x1F,0x12,0x0A,0x0E,0x0A,0x02,0x02,0x07,0x00,0x00},/*"F",38*/
  43          {0x00,0x00,0x1C,0x12,0x01,0x01,0x39,0x11,0x12,0x0C,0x00,0x00},/*"G",39*/
  44          {0x00,0x00,0x33,0x12,0x12,0x1E,0x12,0x12,0x12,0x33,0x00,0x00},/*"H",40*/
  45          {0x00,0x00,0x1F,0x04,0x04,0x04,0x04,0x04,0x04,0x1F,0x00,0x00},/*"I",41*/
  46          {0x00,0x00,0x3E,0x08,0x08,0x08,0x08,0x08,0x08,0x09,0x07,0x00},/*"J",42*/
  47          {0x00,0x00,0x37,0x12,0x0A,0x06,0x0A,0x0A,0x12,0x37,0x00,0x00},/*"K",43*/
  48          {0x00,0x00,0x07,0x02,0x02,0x02,0x02,0x02,0x22,0x3F,0x00,0x00},/*"L",44*/
  49          {0x00,0x00,0x1B,0x1B,0x1B,0x1B,0x15,0x15,0x15,0x15,0x00,0x00},/*"M",45*/
  50          {0x00,0x00,0x3B,0x12,0x16,0x16,0x1A,0x1A,0x12,0x17,0x00,0x00},/*"N",46*/
  51          {0x00,0x00,0x0E,0x11,0x11,0x11,0x11,0x11,0x11,0x0E,0x00,0x00},/*"O",47*/
  52          {0x00,0x00,0x0F,0x12,0x12,0x0E,0x02,0x02,0x02,0x07,0x00,0x00},/*"P",48*/
  53          {0x00,0x00,0x0E,0x11,0x11,0x11,0x11,0x17,0x19,0x0E,0x18,0x00},/*"Q",49*/
  54          {0x00,0x00,0x0F,0x12,0x12,0x0E,0x0A,0x12,0x12,0x37,0x00,0x00},/*"R",50*/
C51 COMPILER V9.60.0.0   TFTLCD                                                            01/08/2021 19:05:39 PAGE 2   

  55          {0x00,0x00,0x1E,0x11,0x01,0x06,0x08,0x10,0x11,0x0F,0x00,0x00},/*"S",51*/
  56          {0x00,0x00,0x1F,0x15,0x04,0x04,0x04,0x04,0x04,0x0E,0x00,0x00},/*"T",52*/
  57          {0x00,0x00,0x33,0x12,0x12,0x12,0x12,0x12,0x12,0x0C,0x00,0x00},/*"U",53*/
  58          {0x00,0x00,0x33,0x12,0x12,0x0A,0x0A,0x0C,0x04,0x04,0x00,0x00},/*"V",54*/
  59          {0x00,0x00,0x15,0x15,0x15,0x0E,0x0A,0x0A,0x0A,0x0A,0x00,0x00},/*"W",55*/
  60          {0x00,0x00,0x1B,0x0A,0x0A,0x04,0x04,0x0A,0x0A,0x1B,0x00,0x00},/*"X",56*/
  61          {0x00,0x00,0x1B,0x0A,0x0A,0x04,0x04,0x04,0x04,0x0E,0x00,0x00},/*"Y",57*/
  62          {0x00,0x00,0x1F,0x09,0x08,0x04,0x04,0x02,0x12,0x1F,0x00,0x00},/*"Z",58*/
  63          {0x00,0x1C,0x04,0x04,0x04,0x04,0x04,0x04,0x04,0x04,0x1C,0x00},/*"[",59*/
  64          {0x00,0x02,0x02,0x02,0x04,0x04,0x08,0x08,0x08,0x10,0x00,0x00},/*"\",60*/
  65          {0x00,0x0E,0x08,0x08,0x08,0x08,0x08,0x08,0x08,0x08,0x0E,0x00},/*"]",61*/
  66          {0x00,0x04,0x0A,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00},/*"^",62*/
  67          {0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x3F},/*"_",63*/
  68          {0x00,0x04,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00},/*"`",64*/
  69          {0x00,0x00,0x00,0x00,0x00,0x0C,0x12,0x1C,0x12,0x3C,0x00,0x00},/*"a",65*/
  70          {0x00,0x00,0x03,0x02,0x02,0x0E,0x12,0x12,0x12,0x0E,0x00,0x00},/*"b",66*/
  71          {0x00,0x00,0x00,0x00,0x00,0x1C,0x12,0x02,0x02,0x1C,0x00,0x00},/*"c",67*/
  72          {0x00,0x00,0x18,0x10,0x10,0x1C,0x12,0x12,0x12,0x3C,0x00,0x00},/*"d",68*/
  73          {0x00,0x00,0x00,0x00,0x00,0x0C,0x12,0x1E,0x02,0x1C,0x00,0x00},/*"e",69*/
  74          {0x00,0x00,0x38,0x04,0x04,0x1E,0x04,0x04,0x04,0x1E,0x00,0x00},/*"f",70*/
  75          {0x00,0x00,0x00,0x00,0x00,0x3C,0x12,0x0C,0x02,0x1E,0x22,0x1C},/*"g",71*/
  76          {0x00,0x00,0x03,0x02,0x02,0x0E,0x12,0x12,0x12,0x37,0x00,0x00},/*"h",72*/
  77          {0x00,0x00,0x04,0x00,0x00,0x06,0x04,0x04,0x04,0x0E,0x00,0x00},/*"i",73*/
  78          {0x00,0x00,0x08,0x00,0x00,0x0C,0x08,0x08,0x08,0x08,0x08,0x07},/*"j",74*/
  79          {0x00,0x00,0x03,0x02,0x02,0x3A,0x0A,0x0E,0x12,0x37,0x00,0x00},/*"k",75*/
  80          {0x00,0x00,0x07,0x04,0x04,0x04,0x04,0x04,0x04,0x1F,0x00,0x00},/*"l",76*/
  81          {0x00,0x00,0x00,0x00,0x00,0x0F,0x15,0x15,0x15,0x15,0x00,0x00},/*"m",77*/
  82          {0x00,0x00,0x00,0x00,0x00,0x0F,0x12,0x12,0x12,0x37,0x00,0x00},/*"n",78*/
  83          {0x00,0x00,0x00,0x00,0x00,0x0C,0x12,0x12,0x12,0x0C,0x00,0x00},/*"o",79*/
  84          {0x00,0x00,0x00,0x00,0x00,0x0F,0x12,0x12,0x12,0x0E,0x02,0x07},/*"p",80*/
  85          {0x00,0x00,0x00,0x00,0x00,0x1C,0x12,0x12,0x12,0x1C,0x10,0x38},/*"q",81*/
  86          {0x00,0x00,0x00,0x00,0x00,0x1B,0x06,0x02,0x02,0x07,0x00,0x00},/*"r",82*/
  87          {0x00,0x00,0x00,0x00,0x00,0x1E,0x02,0x0C,0x10,0x1E,0x00,0x00},/*"s",83*/
  88          {0x00,0x00,0x00,0x04,0x04,0x0E,0x04,0x04,0x04,0x18,0x00,0x00},/*"t",84*/
  89          {0x00,0x00,0x00,0x00,0x00,0x1B,0x12,0x12,0x12,0x3C,0x00,0x00},/*"u",85*/
  90          {0x00,0x00,0x00,0x00,0x00,0x37,0x12,0x0A,0x0C,0x04,0x00,0x00},/*"v",86*/
  91          {0x00,0x00,0x00,0x00,0x00,0x15,0x15,0x0E,0x0A,0x0A,0x00,0x00},/*"w",87*/
  92          {0x00,0x00,0x00,0x00,0x00,0x1B,0x0A,0x04,0x0A,0x1B,0x00,0x00},/*"x",88*/
  93          {0x00,0x00,0x00,0x00,0x00,0x37,0x12,0x0A,0x0C,0x04,0x04,0x03},/*"y",89*/
  94          {0x00,0x00,0x00,0x00,0x00,0x1E,0x08,0x04,0x04,0x1E,0x00,0x00},/*"z",90*/
  95          {0x00,0x18,0x08,0x08,0x08,0x04,0x08,0x08,0x08,0x08,0x18,0x00},/*"{",91*/
  96          {0x08,0x08,0x08,0x08,0x08,0x08,0x08,0x08,0x08,0x08,0x08,0x08},/*"|",92*/
  97          {0x00,0x06,0x04,0x04,0x04,0x08,0x04,0x04,0x04,0x04,0x06,0x00},/*"}",93*/
  98          {0x02,0x25,0x18,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00} /*"~",94*/
  99          }; 
 100          
 101          code  const uint8 asc2_1608[95][16]={
 102          {0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00},/*" ",0*/
 103          {0x00,0x00,0x00,0x08,0x08,0x08,0x08,0x08,0x08,0x08,0x00,0x00,0x18,0x18,0x00,0x00},/*"!",1*/
 104          {0x00,0x48,0x6C,0x24,0x12,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00},/*""",2*/
 105          {0x00,0x00,0x00,0x24,0x24,0x24,0x7F,0x12,0x12,0x12,0x7F,0x12,0x12,0x12,0x00,0x00},/*"#",3*/
 106          {0x00,0x00,0x08,0x1C,0x2A,0x2A,0x0A,0x0C,0x18,0x28,0x28,0x2A,0x2A,0x1C,0x08,0x08},/*"$",4*/
 107          {0x00,0x00,0x00,0x22,0x25,0x15,0x15,0x15,0x2A,0x58,0x54,0x54,0x54,0x22,0x00,0x00},/*"%",5*/
 108          {0x00,0x00,0x00,0x0C,0x12,0x12,0x12,0x0A,0x76,0x25,0x29,0x11,0x91,0x6E,0x00,0x00},/*"&",6*/
 109          {0x00,0x06,0x06,0x04,0x03,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00},/*"'",7*/
 110          {0x00,0x40,0x20,0x10,0x10,0x08,0x08,0x08,0x08,0x08,0x08,0x10,0x10,0x20,0x40,0x00},/*"(",8*/
 111          {0x00,0x02,0x04,0x08,0x08,0x10,0x10,0x10,0x10,0x10,0x10,0x08,0x08,0x04,0x02,0x00},/*")",9*/
 112          {0x00,0x00,0x00,0x00,0x08,0x08,0x6B,0x1C,0x1C,0x6B,0x08,0x08,0x00,0x00,0x00,0x00},/*"*",10*/
 113          {0x00,0x00,0x00,0x00,0x08,0x08,0x08,0x08,0x7F,0x08,0x08,0x08,0x08,0x00,0x00,0x00},/*"+",11*/
 114          {0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x06,0x06,0x04,0x03},/*",",12*/
 115          {0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0xFE,0x00,0x00,0x00,0x00,0x00,0x00,0x00},/*"-",13*/
 116          {0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x06,0x06,0x00,0x00},/*".",14*/
C51 COMPILER V9.60.0.0   TFTLCD                                                            01/08/2021 19:05:39 PAGE 3   

 117          {0x00,0x00,0x80,0x40,0x40,0x20,0x20,0x10,0x10,0x08,0x08,0x04,0x04,0x02,0x02,0x00},/*"/",15*/
 118          {0x00,0x00,0x00,0x18,0x24,0x42,0x42,0x42,0x42,0x42,0x42,0x42,0x24,0x18,0x00,0x00},/*"0",16*/
 119          {0x00,0x00,0x00,0x08,0x0E,0x08,0x08,0x08,0x08,0x08,0x08,0x08,0x08,0x3E,0x00,0x00},/*"1",17*/
 120          {0x00,0x00,0x00,0x3C,0x42,0x42,0x42,0x20,0x20,0x10,0x08,0x04,0x42,0x7E,0x00,0x00},/*"2",18*/
 121          {0x00,0x00,0x00,0x3C,0x42,0x42,0x20,0x18,0x20,0x40,0x40,0x42,0x22,0x1C,0x00,0x00},/*"3",19*/
 122          {0x00,0x00,0x00,0x20,0x30,0x28,0x24,0x24,0x22,0x22,0x7E,0x20,0x20,0x78,0x00,0x00},/*"4",20*/
 123          {0x00,0x00,0x00,0x7E,0x02,0x02,0x02,0x1A,0x26,0x40,0x40,0x42,0x22,0x1C,0x00,0x00},/*"5",21*/
 124          {0x00,0x00,0x00,0x38,0x24,0x02,0x02,0x1A,0x26,0x42,0x42,0x42,0x24,0x18,0x00,0x00},/*"6",22*/
 125          {0x00,0x00,0x00,0x7E,0x22,0x22,0x10,0x10,0x08,0x08,0x08,0x08,0x08,0x08,0x00,0x00},/*"7",23*/     
 126          {0x00,0x00,0x00,0x3C,0x42,0x42,0x42,0x24,0x18,0x24,0x42,0x42,0x42,0x3C,0x00,0x00},/*"8",24*/
 127          {0x00,0x00,0x00,0x18,0x24,0x42,0x42,0x42,0x64,0x58,0x40,0x40,0x24,0x1C,0x00,0x00},/*"9",25*/
 128          {0x00,0x00,0x00,0x00,0x00,0x00,0x18,0x18,0x00,0x00,0x00,0x00,0x18,0x18,0x00,0x00},/*":",26*/
 129          {0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x08,0x00,0x00,0x00,0x00,0x00,0x08,0x08,0x04},/*";",27*/
 130          {0x00,0x00,0x00,0x40,0x20,0x10,0x08,0x04,0x02,0x04,0x08,0x10,0x20,0x40,0x00,0x00},/*"<",28*/
 131          {0x00,0x00,0x00,0x00,0x00,0x00,0x7F,0x00,0x00,0x00,0x7F,0x00,0x00,0x00,0x00,0x00},/*"=",29*/
 132          {0x00,0x00,0x00,0x02,0x04,0x08,0x10,0x20,0x40,0x20,0x10,0x08,0x04,0x02,0x00,0x00},/*">",30*/
 133          {0x00,0x00,0x00,0x3C,0x42,0x42,0x46,0x40,0x20,0x10,0x10,0x00,0x18,0x18,0x00,0x00},/*"?",31*/
 134          {0x00,0x00,0x00,0x1C,0x22,0x5A,0x55,0x55,0x55,0x55,0x2D,0x42,0x22,0x1C,0x00,0x00},/*"@",32*/
 135          {0x00,0x00,0x00,0x08,0x08,0x18,0x14,0x14,0x24,0x3C,0x22,0x42,0x42,0xE7,0x00,0x00},/*"A",33*/
 136          {0x00,0x00,0x00,0x1F,0x22,0x22,0x22,0x1E,0x22,0x42,0x42,0x42,0x22,0x1F,0x00,0x00},/*"B",34*/
 137          {0x00,0x00,0x00,0x7C,0x42,0x42,0x01,0x01,0x01,0x01,0x01,0x42,0x22,0x1C,0x00,0x00},/*"C",35*/
 138          {0x00,0x00,0x00,0x1F,0x22,0x42,0x42,0x42,0x42,0x42,0x42,0x42,0x22,0x1F,0x00,0x00},/*"D",36*/
 139          {0x00,0x00,0x00,0x3F,0x42,0x12,0x12,0x1E,0x12,0x12,0x02,0x42,0x42,0x3F,0x00,0x00},/*"E",37*/
 140          {0x00,0x00,0x00,0x3F,0x42,0x12,0x12,0x1E,0x12,0x12,0x02,0x02,0x02,0x07,0x00,0x00},/*"F",38*/
 141          {0x00,0x00,0x00,0x3C,0x22,0x22,0x01,0x01,0x01,0x71,0x21,0x22,0x22,0x1C,0x00,0x00},/*"G",39*/
 142          {0x00,0x00,0x00,0xE7,0x42,0x42,0x42,0x42,0x7E,0x42,0x42,0x42,0x42,0xE7,0x00,0x00},/*"H",40*/
 143          {0x00,0x00,0x00,0x3E,0x08,0x08,0x08,0x08,0x08,0x08,0x08,0x08,0x08,0x3E,0x00,0x00},/*"I",41*/
 144          {0x00,0x00,0x00,0x7C,0x10,0x10,0x10,0x10,0x10,0x10,0x10,0x10,0x10,0x10,0x11,0x0F},/*"J",42*/
 145          {0x00,0x00,0x00,0x77,0x22,0x12,0x0A,0x0E,0x0A,0x12,0x12,0x22,0x22,0x77,0x00,0x00},/*"K",43*/
 146          {0x00,0x00,0x00,0x07,0x02,0x02,0x02,0x02,0x02,0x02,0x02,0x02,0x42,0x7F,0x00,0x00},/*"L",44*/
 147          {0x00,0x00,0x00,0x77,0x36,0x36,0x36,0x36,0x2A,0x2A,0x2A,0x2A,0x2A,0x6B,0x00,0x00},/*"M",45*/
 148          {0x00,0x00,0x00,0xE3,0x46,0x46,0x4A,0x4A,0x52,0x52,0x52,0x62,0x62,0x47,0x00,0x00},/*"N",46*/
 149          {0x00,0x00,0x00,0x1C,0x22,0x41,0x41,0x41,0x41,0x41,0x41,0x41,0x22,0x1C,0x00,0x00},/*"O",47*/
 150          {0x00,0x00,0x00,0x3F,0x42,0x42,0x42,0x42,0x3E,0x02,0x02,0x02,0x02,0x07,0x00,0x00},/*"P",48*/
 151          {0x00,0x00,0x00,0x1C,0x22,0x41,0x41,0x41,0x41,0x41,0x4D,0x53,0x32,0x1C,0x60,0x00},/*"Q",49*/
 152          {0x00,0x00,0x00,0x3F,0x42,0x42,0x42,0x3E,0x12,0x12,0x22,0x22,0x42,0xC7,0x00,0x00},/*"R",50*/
 153          {0x00,0x00,0x00,0x7C,0x42,0x42,0x02,0x04,0x18,0x20,0x40,0x42,0x42,0x3E,0x00,0x00},/*"S",51*/
 154          {0x00,0x00,0x00,0x7F,0x49,0x08,0x08,0x08,0x08,0x08,0x08,0x08,0x08,0x1C,0x00,0x00},/*"T",52*/
 155          {0x00,0x00,0x00,0xE7,0x42,0x42,0x42,0x42,0x42,0x42,0x42,0x42,0x42,0x3C,0x00,0x00},/*"U",53*/
 156          {0x00,0x00,0x00,0xE7,0x42,0x42,0x22,0x24,0x24,0x14,0x14,0x18,0x08,0x08,0x00,0x00},/*"V",54*/
 157          {0x00,0x00,0x00,0x6B,0x49,0x49,0x49,0x49,0x55,0x55,0x36,0x22,0x22,0x22,0x00,0x00},/*"W",55*/
 158          {0x00,0x00,0x00,0xE7,0x42,0x24,0x24,0x18,0x18,0x18,0x24,0x24,0x42,0xE7,0x00,0x00},/*"X",56*/
 159          {0x00,0x00,0x00,0x77,0x22,0x22,0x14,0x14,0x08,0x08,0x08,0x08,0x08,0x1C,0x00,0x00},/*"Y",57*/
 160          {0x00,0x00,0x00,0x7E,0x21,0x20,0x10,0x10,0x08,0x04,0x04,0x42,0x42,0x3F,0x00,0x00},/*"Z",58*/
 161          {0x00,0x78,0x08,0x08,0x08,0x08,0x08,0x08,0x08,0x08,0x08,0x08,0x08,0x08,0x78,0x00},/*"[",59*/
 162          {0x00,0x00,0x02,0x02,0x04,0x04,0x08,0x08,0x08,0x10,0x10,0x20,0x20,0x20,0x40,0x40},/*"\",60*/
 163          {0x00,0x1E,0x10,0x10,0x10,0x10,0x10,0x10,0x10,0x10,0x10,0x10,0x10,0x10,0x1E,0x00},/*"]",61*/
 164          {0x00,0x38,0x44,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00},/*"^",62*/
 165          {0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0xFF},/*"_",63*/
 166          {0x00,0x06,0x08,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00},/*"`",64*/
 167          {0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x3C,0x42,0x78,0x44,0x42,0x42,0xFC,0x00,0x00},/*"a",65*/
 168          {0x00,0x00,0x00,0x03,0x02,0x02,0x02,0x1A,0x26,0x42,0x42,0x42,0x26,0x1A,0x00,0x00},/*"b",66*/
 169          {0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x38,0x44,0x02,0x02,0x02,0x44,0x38,0x00,0x00},/*"c",67*/
 170          {0x00,0x00,0x00,0x60,0x40,0x40,0x40,0x78,0x44,0x42,0x42,0x42,0x64,0xD8,0x00,0x00},/*"d",68*/
 171          {0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x3C,0x42,0x7E,0x02,0x02,0x42,0x3C,0x00,0x00},/*"e",69*/
 172          {0x00,0x00,0x00,0xF0,0x88,0x08,0x08,0x7E,0x08,0x08,0x08,0x08,0x08,0x3E,0x00,0x00},/*"f",70*/
 173          {0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x7C,0x22,0x22,0x1C,0x02,0x3C,0x42,0x42,0x3C},/*"g",71*/
 174          {0x00,0x00,0x00,0x03,0x02,0x02,0x02,0x3A,0x46,0x42,0x42,0x42,0x42,0xE7,0x00,0x00},/*"h",72*/
 175          {0x00,0x00,0x00,0x0C,0x0C,0x00,0x00,0x0E,0x08,0x08,0x08,0x08,0x08,0x3E,0x00,0x00},/*"i",73*/
 176          {0x00,0x00,0x00,0x30,0x30,0x00,0x00,0x38,0x20,0x20,0x20,0x20,0x20,0x20,0x22,0x1E},/*"j",74*/
 177          {0x00,0x00,0x00,0x03,0x02,0x02,0x02,0x72,0x12,0x0A,0x16,0x12,0x22,0x77,0x00,0x00},/*"k",75*/
 178          {0x00,0x00,0x00,0x0E,0x08,0x08,0x08,0x08,0x08,0x08,0x08,0x08,0x08,0x3E,0x00,0x00},/*"l",76*/
C51 COMPILER V9.60.0.0   TFTLCD                                                            01/08/2021 19:05:39 PAGE 4   

 179          {0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x7F,0x92,0x92,0x92,0x92,0x92,0xB7,0x00,0x00},/*"m",77*/
 180          {0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x3B,0x46,0x42,0x42,0x42,0x42,0xE7,0x00,0x00},/*"n",78*/
 181          {0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x3C,0x42,0x42,0x42,0x42,0x42,0x3C,0x00,0x00},/*"o",79*/
 182          {0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x1B,0x26,0x42,0x42,0x42,0x22,0x1E,0x02,0x07},/*"p",80*/
 183          {0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x78,0x44,0x42,0x42,0x42,0x44,0x78,0x40,0xE0},/*"q",81*/
 184          {0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x77,0x4C,0x04,0x04,0x04,0x04,0x1F,0x00,0x00},/*"r",82*/
 185          {0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x7C,0x42,0x02,0x3C,0x40,0x42,0x3E,0x00,0x00},/*"s",83*/
 186          {0x00,0x00,0x00,0x00,0x00,0x08,0x08,0x3E,0x08,0x08,0x08,0x08,0x08,0x30,0x00,0x00},/*"t",84*/
 187          {0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x63,0x42,0x42,0x42,0x42,0x62,0xDC,0x00,0x00},/*"u",85*/
 188          {0x00,0x00,0x00,0x00,0x00,0x00,0x00,0xE7,0x42,0x24,0x24,0x14,0x08,0x08,0x00,0x00},/*"v",86*/
 189          {0x00,0x00,0x00,0x00,0x00,0x00,0x00,0xEB,0x49,0x49,0x55,0x55,0x22,0x22,0x00,0x00},/*"w",87*/
 190          {0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x76,0x24,0x18,0x18,0x18,0x24,0x6E,0x00,0x00},/*"x",88*/
 191          {0x00,0x00,0x00,0x00,0x00,0x00,0x00,0xE7,0x42,0x24,0x24,0x14,0x18,0x08,0x08,0x07},/*"y",89*/
 192          {0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x7E,0x22,0x10,0x08,0x08,0x44,0x7E,0x00,0x00},/*"z",90*/
 193          {0x00,0xC0,0x20,0x20,0x20,0x20,0x20,0x10,0x20,0x20,0x20,0x20,0x20,0x20,0xC0,0x00},/*"{",91*/
 194          {0x10,0x10,0x10,0x10,0x10,0x10,0x10,0x10,0x10,0x10,0x10,0x10,0x10,0x10,0x10,0x10},/*"|",92*/
 195          {0x00,0x06,0x08,0x08,0x08,0x08,0x08,0x10,0x08,0x08,0x08,0x08,0x08,0x08,0x06,0x00},/*"}",93*/
 196          {0x0C,0x32,0xC2,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00}/*"~",94*/
 197          };
 198          
 199          //LCD参数
 200           _lcd_dev lcddev;       //管理LCD重要参数
 201           
 202          //LCD的画笔颜色和背景色    
 203          uint16 _tft_lcd_point_color = 0x0000;   //画笔颜色
 204          uint16 _tft_lcd_back_color = 0xFFFF;    //背景色 
 205          //管理LCD重要参数
 206          //默认为竖屏
 207          
 208          //========================================================================
 209          // 描述: LCD写入一个字节数据.
 210          // 参数: HVAL:写入的字节数据.
 211          // 返回: none.
 212          //========================================================================
 213          #if TFT_LCD_USE_8BIT_MODEL
 214          void tft_lcd_write(uint8 HVAL)
 215          {
 216   1              TFT_LCD_CS = 0;
 217   1              TFT_LCD_WR = 0; 
 218   1              TFT_LCD_DATAPORTH = HVAL;
 219   1              _nop_(); _nop_(); _nop_(); _nop_();
 220   1              TFT_LCD_WR = 1;
 221   1              TFT_LCD_CS = 1;
 222   1      }
 223          #else
              void tft_lcd_write(uint8 HVAL,uint8 LVAL)
              {
                      TFT_LCD_CS = 0;
                      TFT_LCD_WR = 0; 
                      TFT_LCD_DATAPORTH = HVAL;
                      TFT_LCD_DATAPORTL = LVAL;
                      TFT_LCD_WR = 1;
                      TFT_LCD_CS = 1;
              }
              #endif
 234          
 235          //========================================================================
 236          // 描述: LCD读取16位数据.
 237          // 参数: none.
 238          // 返回: 读取到的16位数据.
 239          //========================================================================
 240          uint16 tft_lcd_read()
C51 COMPILER V9.60.0.0   TFTLCD                                                            01/08/2021 19:05:39 PAGE 5   

 241          {
 242   1              uint16 d;
 243   1              TFT_LCD_CS = 0;
 244   1              TFT_LCD_RD = 0;
 245   1              delay1us(); //delay 1 us
 246   1              d = TFT_LCD_DATAPORTH;
 247   1              d = (d<<8);
 248   1              TFT_LCD_RD = 1;
 249   1              TFT_LCD_CS = 1;
 250   1              return d;
 251   1      }
 252          
 253          //========================================================================
 254          // 描述: LCD写入命令.
 255          // 参数: Reg:写入的命令.
 256          // 返回: none.
 257          //========================================================================
 258          void tft_lcd_wr_reg(uint16 Reg)  
 259          {       
 260   1              TFT_LCD_RS=0;
 261   1              #if TFT_LCD_USE_8BIT_MODEL
 262   1              tft_lcd_write(Reg&0xFF);
 263   1              #else
                      lcd_write((Reg>>8)&0xFF,Reg&0xFF);
                      #endif
 266   1      } 
 267          
 268          //========================================================================
 269          // 描述: LCD写入数据.
 270          // 参数: Data:写入的数据.
 271          // 返回: none.
 272          //========================================================================
 273          void tft_lcd_wr_data(uint16 Data)
 274          {
 275   1              TFT_LCD_RS=1;
 276   1              #if TFT_LCD_USE_8BIT_MODEL
 277   1              tft_lcd_write(Data&0xFF);
 278   1              #else
                      lcd_write((Data>>8)&0xFF,Data&0xFF);
                      #endif
 281   1      }
 282          
 283          
 284          //========================================================================
 285          // 描述: LCD读取数据.
 286          // 参数: none.
 287          // 返回: 读取到的数据.
 288          //========================================================================
 289          uint16 tft_lcd_rd_data()
 290          {
 291   1              TFT_LCD_RS=1;
 292   1              #if TFT_LCD_USE_8BIT_MODEL
 293   1              return (tft_lcd_read()>>8);
 294   1              #else
                      return tft_lcd_read();
                      #endif
 297   1      }
 298          
 299          //========================================================================
 300          // 描述: LCD写入16位数据.
 301          // 参数: Data:写入的数据.
 302          // 返回: none.
C51 COMPILER V9.60.0.0   TFTLCD                                                            01/08/2021 19:05:39 PAGE 6   

 303          //========================================================================
 304          void tft_lcd_wr_data_16bit(uint16 Data)
 305          {
 306   1              TFT_LCD_RS=1;
 307   1              #if TFT_LCD_USE_8BIT_MODEL
 308   1              tft_lcd_write((Data>>8)&0xFF);
 309   1              tft_lcd_write(Data&0xFF);
 310   1              #else
                      tft_lcd_write((Data>>8)&0xFF,Data&0xFF);
                      #endif
 313   1      }
 314          
 315          //========================================================================
 316          // 描述: 将RGB转换为565格式.
 317          // 参数: r,g,b:需要转换的RGB值.
 318          // 返回: 转换完成的565格式的16位数值.
 319          //========================================================================
 320          uint16 tft_color_to_565(uint8 r, uint8 g, uint8 b)
 321          {
 322   1              return ((r & 0xF8) << 8) | ((g & 0xFC) << 3) | ((b & 0xF8) >> 3);
 323   1      }
 324          
 325          //========================================================================
 326          // 描述: LCD读取565格式的16位数值.
 327          // 参数: none.
 328          // 返回: 565格式的数据.
 329          //========================================================================
 330          uint16 tft_lcd_rd_data_16bit()
 331          {
 332   1              uint16 r,g,b;
 333   1              TFT_LCD_RS = 1;
 334   1              TFT_LCD_CS = 0;
 335   1              
 336   1              //dummy data
 337   1              TFT_LCD_RD = 0;
 338   1              delay1us(); //delay 1us
 339   1              r = TFT_LCD_DATAPORTH;
 340   1              r = (r<<8);
 341   1              TFT_LCD_RD = 1;
 342   1              
 343   1              //8bit:red data
 344   1              //16bit:red and green data
 345   1              TFT_LCD_RD = 0;
 346   1              delay1us(); //delay 1us
 347   1              r = TFT_LCD_DATAPORTH;
 348   1              r = (r<<8);
 349   1              TFT_LCD_RD = 1;
 350   1              
 351   1              //8bit:green data
 352   1              //16bit:blue data
 353   1              TFT_LCD_RD = 0;
 354   1              delay1us(); //delay 1us
 355   1              g = TFT_LCD_DATAPORTH;
 356   1              g = (g<<8);
 357   1              TFT_LCD_RD = 1;
 358   1              
 359   1              #if TFT_LCD_USE_8BIT_MODEL      
 360   1              TFT_LCD_RD = 0;
 361   1              delay1us(); //delay 1us
 362   1              b = TFT_LCD_DATAPORTH;
 363   1              b = (b<<8);
 364   1              TFT_LCD_RD = 1;
C51 COMPILER V9.60.0.0   TFTLCD                                                            01/08/2021 19:05:39 PAGE 7   

 365   1              r >>= 8;
 366   1              g >>= 8;
 367   1              b >>= 8;
 368   1              #else
                      b = g>>8;
                      r = r>>8;
                      g = r&0xFF;
                      #endif
 373   1              TFT_LCD_CS = 1;
 374   1              return tft_color_to_565(r, g, b);
 375   1      }
 376          
 377          //========================================================================
 378          // 描述: LCD写寄存器.
 379          // 参数: LCD_Reg:写的寄存器地址; LCD_RegValue:写入的值.
 380          // 返回: none.
 381          //========================================================================
 382          void tft_lcd_writereg(uint16 LCD_Reg, uint16 LCD_RegValue)
 383          {
 384   1              tft_lcd_wr_reg(LCD_Reg);
 385   1              tft_lcd_wr_data(LCD_RegValue);
 386   1      }
 387          
 388          //========================================================================
 389          // 描述: LCD读寄存器.
 390          // 参数: LCD_Reg:读的寄存器地址; Rval:读取到的值; n:需要连续读取的数量.
 391          // 返回: none.
 392          //========================================================================
 393          void tft_lcd_readreg(uint8 LCD_Reg, uint8* Rval, int n)
 394          {
 395   1              tft_lcd_wr_reg(LCD_Reg);
 396   1              TFT_LCD_DATAPORTH = 0xFF; //拉高P6
 397   1      
 398   1              //TFT_LCD_DATAPORTL = 0xFF; //拉高P2
 399   1      
 400   1              TFT_LCD_DATAPORTH_IN;   //P6口设置成输入口
 401   1      
 402   1              while (n--)
 403   1              {
 404   2                      *(Rval++) = tft_lcd_rd_data();
 405   2              }
 406   1      
 407   1              TFT_LCD_DATAPORTH_OUT;          //P6口设置为推挽输出
 408   1              TFT_LCD_DATAPORTH = 0xFF; //拉高P6
 409   1              //TFT_LCD_DATAPORTL = 0xFF; //拉高P2
 410   1      
 411   1      }
 412          
 413          //========================================================================
 414          // 描述: LCD写GRAM.
 415          // 参数: none.
 416          // 返回: none.
 417          //========================================================================
 418          void tft_lcd_writeram_prepare()
 419          {
 420   1              tft_lcd_wr_reg(lcddev.wramcmd);
 421   1      }
 422          
 423          //========================================================================
 424          // 描述: LCD读GRAM.
 425          // 参数: none.
 426          // 返回: none.
C51 COMPILER V9.60.0.0   TFTLCD                                                            01/08/2021 19:05:39 PAGE 8   

 427          //========================================================================
 428          void tft_lcd_readram_prepare()
 429          {
 430   1              tft_lcd_wr_reg(lcddev.rramcmd);
 431   1      }
 432          
 433          //========================================================================
 434          // 描述: LCD清屏.
 435          // 参数: color:清屏的颜色.
 436          // 返回: none.
 437          //========================================================================
 438          void tft_lcd_clear(uint16 color)
 439          {
 440   1              uint16 i, j;
 441   1              tft_lcd_set_windows(0, 0, lcddev.width - 1, lcddev.height - 1);
 442   1              for (i = 0; i < lcddev.width; i++)
 443   1              {
 444   2                      for (j = 0; j < lcddev.height; j++)
 445   2                      {
 446   3                              tft_lcd_wr_data_16bit(color);
 447   3                      }
 448   2              }
 449   1      }
 450          
 451          //========================================================================
 452          // 描述: LCD画点.
 453          // 参数: x,y: 坐标.
 454          // 返回: none.
 455          //========================================================================
 456          void tft_lcd_draw_point(uint16 x, uint16 y)
 457          {
 458   1              tft_lcd_set_windows(x, y, x, y);//设置光标位置 
 459   1              tft_lcd_wr_data_16bit(_tft_lcd_point_color);
 460   1      }
 461          
 462          //========================================================================
 463          // 描述: LCD读点.
 464          // 参数: x,y: 坐标.
 465          // 返回: 读到的颜色值.
 466          //========================================================================
 467          uint16 tft_lcd_read_point(uint16 x, uint16 y)
 468          {
 469   1              uint16 color;
 470   1              if (x >= lcddev.width || y >= lcddev.height)
 471   1              {
 472   2                      return 0;       //超过了范围,直接返回   
 473   2              }
 474   1              tft_lcd_set_cursor(x, y);//设置光标位置 
 475   1              tft_lcd_readram_prepare();
 476   1              TFT_LCD_DATAPORTH = 0xFF; //拉高P6
 477   1              //TFT_LCD_DATAPORTL = 0xFF; //拉高P2
 478   1      
 479   1              TFT_LCD_DATAPORTH_IN;   //P6口设置成输入口
 480   1              color = tft_lcd_rd_data_16bit();
 481   1              
 482   1              TFT_LCD_DATAPORTH_OUT;//P6口设置成推挽输出
 483   1      
 484   1              TFT_LCD_DATAPORTH = 0xFF; //拉高P0
 485   1              //TFT_LCD_DATAPORTL = 0xFF; //拉高P2
 486   1      
 487   1              return color;
 488   1      }
C51 COMPILER V9.60.0.0   TFTLCD                                                            01/08/2021 19:05:39 PAGE 9   

 489          
 490          //========================================================================
 491          // 描述: LCD的GPIO配置.
 492          // 参数: none.
 493          // 返回: none.
 494          //========================================================================
 495          void tft_lcd_set_gpio()
 496          {
 497   1              TFT_LCD_RD_OUT;   //设置为推挽输出
 498   1              TFT_LCD_WR_OUT;
 499   1              TFT_LCD_RS_OUT;
 500   1              TFT_LCD_CS_OUT;
 501   1              TFT_LCD_RESET_OUT;
 502   1              TFT_LCD_DATAPORTH_OUT;//P6口设置成推挽输出
 503   1      }
 504          
 505          //========================================================================
 506          // 描述: LCD复位.
 507          // 参数: none.
 508          // 返回: none.
 509          //========================================================================
 510          void tft_lcd_reset()
 511          {
 512   1              delay(50);
 513   1              TFT_LCD_RESET = 0;
 514   1              delay(50);
 515   1              TFT_LCD_RESET = 1;
 516   1              delay(50);
 517   1      }
 518          
 519          //========================================================================
 520          // 描述: LCD初始化.
 521          // 参数: none.
 522          // 返回: none.
 523          //========================================================================
 524          void tft_lcd_init()
 525          {
 526   1              tft_lcd_set_gpio();
 527   1              tft_lcd_reset(); //初始化之前复位
 528   1      
 529   1              //*************2.4inch ILI9341初始化**********//        
 530   1              tft_lcd_wr_reg(0x01);           //softreset
 531   1              delay(50); 
 532   1              tft_lcd_wr_reg(0x28);           //displayoff
 533   1      
 534   1              tft_lcd_wr_reg(0xF6);           //Interface Control needs EXTC=1 MV_EOR=0, TM=0, RIM=0
 535   1              tft_lcd_wr_data(0x01); 
 536   1              tft_lcd_wr_data(0x01); 
 537   1              tft_lcd_wr_data(0x00); 
 538   1      
 539   1      
 540   1              tft_lcd_wr_reg(0xCF);           //Power Control B [00 81 30]
 541   1              tft_lcd_wr_data(0x00); 
 542   1              tft_lcd_wr_data(0x81); 
 543   1              tft_lcd_wr_data(0X30);
 544   1      
 545   1              tft_lcd_wr_reg(0xED);           //Power On Seq [55 01 23 01]
 546   1              tft_lcd_wr_data(0x64); 
 547   1              tft_lcd_wr_data(0x03); 
 548   1              tft_lcd_wr_data(0X12); 
 549   1              tft_lcd_wr_data(0X81); 
 550   1      
C51 COMPILER V9.60.0.0   TFTLCD                                                            01/08/2021 19:05:39 PAGE 10  

 551   1              tft_lcd_wr_reg(0xE8);           //Driver Timing A [04 11 7A]
 552   1              tft_lcd_wr_data(0x85); 
 553   1              tft_lcd_wr_data(0x10); 
 554   1              tft_lcd_wr_data(0x78);
 555   1      
 556   1              tft_lcd_wr_reg(0xCB);           //Power Control A [39 2C 00 34 02]
 557   1              tft_lcd_wr_data(0x39); 
 558   1              tft_lcd_wr_data(0x2C); 
 559   1              tft_lcd_wr_data(0x00); 
 560   1              tft_lcd_wr_data(0x34); 
 561   1              tft_lcd_wr_data(0x02); 
 562   1      
 563   1              tft_lcd_wr_reg(0xF7);           //Pump Ratio [10]
 564   1              tft_lcd_wr_data(0x20);
 565   1      
 566   1              tft_lcd_wr_reg(0xEA);           //Driver Timing B [66 00]
 567   1              tft_lcd_wr_data(0x00); 
 568   1              tft_lcd_wr_data(0x00); 
 569   1      
 570   1              tft_lcd_wr_reg(0xB0);           //RGB Signal [00]
 571   1              tft_lcd_wr_data(0x00); 
 572   1      
 573   1              tft_lcd_wr_reg(0xB4);            //Inversion Control [02] .kbv NLA=1, NLB=1, NLC=1
 574   1              tft_lcd_wr_data(0x00); 
 575   1      
 576   1              tft_lcd_wr_reg(0xC0);    //Power Control 1 [26]
 577   1              tft_lcd_wr_data(0x21);   
 578   1      
 579   1              tft_lcd_wr_reg(0xC1);    //Power Control 2 [00]
 580   1              tft_lcd_wr_data(0x11);    
 581   1      
 582   1              tft_lcd_wr_reg(0xC5);    //VCM control 
 583   1              tft_lcd_wr_data(0x3F);   //3F
 584   1              tft_lcd_wr_data(0x3C);   //3C
 585   1      
 586   1              tft_lcd_wr_reg(0xC7);    //VCM control2 
 587   1              tft_lcd_wr_data(0XB5); 
 588   1      
 589   1              tft_lcd_wr_reg(0x36);    // Memory Access Control 
 590   1              tft_lcd_wr_data(0x48); 
 591   1      
 592   1              tft_lcd_wr_reg(0x3A);    //Pixel read=565, write=565.
 593   1              tft_lcd_wr_data(0x55);  
 594   1      
 595   1              tft_lcd_wr_reg(0xB1);    //Frame Control [00 1B]
 596   1              tft_lcd_wr_data(0x00);   
 597   1              tft_lcd_wr_data(0x1B); 
 598   1      
 599   1              tft_lcd_wr_reg(0xB6);    // Display Function Control 
 600   1              tft_lcd_wr_data(0x0A); 
 601   1              tft_lcd_wr_data(0xA2); 
 602   1      
 603   1              tft_lcd_wr_reg(0xF2);    //Enable 3G [02]
 604   1              tft_lcd_wr_data(0x00); 
 605   1      
 606   1              tft_lcd_wr_reg(0x26);    //Gamma Set [01]
 607   1              tft_lcd_wr_data(0x01); 
 608   1      
 609   1              tft_lcd_wr_reg(0xE0);    //Set Gamma 
 610   1              tft_lcd_wr_data(0x0F); 
 611   1              tft_lcd_wr_data(0x26); 
 612   1              tft_lcd_wr_data(0x24); 
C51 COMPILER V9.60.0.0   TFTLCD                                                            01/08/2021 19:05:39 PAGE 11  

 613   1              tft_lcd_wr_data(0x0B); 
 614   1              tft_lcd_wr_data(0x0E); 
 615   1              tft_lcd_wr_data(0x09); 
 616   1              tft_lcd_wr_data(0x54); 
 617   1              tft_lcd_wr_data(0XA8); 
 618   1              tft_lcd_wr_data(0x46); 
 619   1              tft_lcd_wr_data(0x0C); 
 620   1              tft_lcd_wr_data(0x17); 
 621   1              tft_lcd_wr_data(0x09); 
 622   1              tft_lcd_wr_data(0x0F); 
 623   1              tft_lcd_wr_data(0x07); 
 624   1              tft_lcd_wr_data(0x00);  
 625   1      
 626   1              tft_lcd_wr_reg(0XE1);    //Set Gamma 
 627   1              tft_lcd_wr_data(0x00); 
 628   1              tft_lcd_wr_data(0x19); 
 629   1              tft_lcd_wr_data(0x1B); 
 630   1              tft_lcd_wr_data(0x04); 
 631   1              tft_lcd_wr_data(0x10); 
 632   1              tft_lcd_wr_data(0x07); 
 633   1              tft_lcd_wr_data(0x2A); 
 634   1              tft_lcd_wr_data(0x47); 
 635   1              tft_lcd_wr_data(0x39); 
 636   1              tft_lcd_wr_data(0x03); 
 637   1              tft_lcd_wr_data(0x06); 
 638   1              tft_lcd_wr_data(0x06); 
 639   1              tft_lcd_wr_data(0x30); 
 640   1              tft_lcd_wr_data(0x38); 
 641   1              tft_lcd_wr_data(0x0F); 
 642   1      
 643   1              tft_lcd_wr_reg(0x2B); 
 644   1              tft_lcd_wr_data(0x00);
 645   1              tft_lcd_wr_data(0x00);
 646   1              tft_lcd_wr_data(0x01);
 647   1              tft_lcd_wr_data(0x3f);
 648   1      
 649   1              tft_lcd_wr_reg(0x2A); 
 650   1              tft_lcd_wr_data(0x00);
 651   1              tft_lcd_wr_data(0x00);
 652   1              tft_lcd_wr_data(0x00);
 653   1              tft_lcd_wr_data(0xef);  
 654   1      
 655   1              tft_lcd_wr_reg(0xB7); 
 656   1              tft_lcd_wr_data(0x07);
 657   1      
 658   1              tft_lcd_wr_reg(0x11); //Exit Sleep
 659   1              delay(150);
 660   1              tft_lcd_wr_reg(0x29); //display on
 661   1              lcddev.id = tft_lcd_read_id();  //获取id
 662   1              tft_lcd_direction(0);//设置LCD显示方向 
 663   1              //      LCD_BL=1;//点亮背光              
 664   1      }
 665          
 666          //========================================================================
 667          // 描述: LCD设置窗口.
 668          // 参数: x0,y0:起始坐标; x1,y1:终点坐标.
 669          // 返回: none.
 670          //========================================================================
 671          void tft_lcd_set_windows(uint16 x0, uint16 y0, uint16 x1, uint16 y1)
 672          {
 673   1              tft_lcd_wr_reg(lcddev.setxcmd);
 674   1              tft_lcd_wr_data(x0 >> 8);
C51 COMPILER V9.60.0.0   TFTLCD                                                            01/08/2021 19:05:39 PAGE 12  

 675   1              tft_lcd_wr_data(0x00FF & x0);
 676   1              tft_lcd_wr_data(x1 >> 8);
 677   1              tft_lcd_wr_data(0x00FF & x1);
 678   1      
 679   1              tft_lcd_wr_reg(lcddev.setycmd);
 680   1              tft_lcd_wr_data(y0 >> 8);
 681   1              tft_lcd_wr_data(0x00FF & y0);
 682   1              tft_lcd_wr_data(y1 >> 8);
 683   1              tft_lcd_wr_data(0x00FF & y1);
 684   1      
 685   1              tft_lcd_writeram_prepare();     //开始写入GRAM                                          
 686   1      }
 687          
 688          //========================================================================
 689          // 描述: LCD设置光标.
 690          // 参数: x:横坐标; y:纵坐标;
 691          // 返回: none.
 692          //========================================================================
 693          void tft_lcd_set_cursor(uint16 x, uint16 y)
 694          {
 695   1              tft_lcd_set_windows(x, y, x, y);
 696   1      }
 697          
 698          //========================================================================
 699          // 描述: 设置显示方向.
 700          // 参数: direction:0~3;
 701          // 返回: none.
 702          //========================================================================
 703          void tft_lcd_direction(uint8 direction)
 704          {
 705   1              lcddev.setxcmd = 0x2A;
 706   1              lcddev.setycmd = 0x2B;
 707   1              lcddev.wramcmd = 0x2C;
 708   1              lcddev.rramcmd = 0x2E;
 709   1              switch (direction) {
 710   2              case 0:
 711   2                      lcddev.width = TFT_LCD_LCD_W;
 712   2                      lcddev.height = TFT_LCD_LCD_H;
 713   2                      if(lcddev.id == 0x9341|lcddev.id == 0x9340)
 714   2                              tft_lcd_writereg(0x36,   (1<<3)|(0<<6)); 
 715   2                      else tft_lcd_writereg(0x36,   (0<<3)|(1<<6)); 
 716   2                      break;
 717   2              case 1:
 718   2                      lcddev.width = TFT_LCD_LCD_H;
 719   2                      lcddev.height = TFT_LCD_LCD_W;
 720   2                      if(lcddev.id == 0x9341 | lcddev.id == 0x9340)
 721   2                              tft_lcd_writereg(0x36, (1 << 3) | (1 << 7) | (1 << 5) | (1 << 4) | (1 << 6));
 722   2                      else    tft_lcd_writereg(0x36, (0 << 3) | (1 << 7) | (1 << 5) | (1 << 4) | (1 << 6));
 723   2                      break;
 724   2              case 2:
 725   2                      lcddev.width = TFT_LCD_LCD_W;
 726   2                      lcddev.height = TFT_LCD_LCD_H;
 727   2                      if(lcddev.id == 0x9341 | lcddev.id == 0x9340)
 728   2                              tft_lcd_writereg(0x36, (1 << 3) | (1 << 7) | (1 << 4));
 729   2                      else tft_lcd_writereg(0x36, (0 << 3) | (1 << 7) | (0 << 4)| (1 << 6));
 730   2                      break;
 731   2              case 3:
 732   2                      lcddev.width = TFT_LCD_LCD_H;
 733   2                      lcddev.height = TFT_LCD_LCD_W;
 734   2                      if(lcddev.id == 0x9341 | lcddev.id == 0x9340)
 735   2                              tft_lcd_writereg(0x36, (1 << 3) | (1 << 5));
 736   2                      else tft_lcd_writereg(0x36, (0 << 3) | (1 << 5)); 
C51 COMPILER V9.60.0.0   TFTLCD                                                            01/08/2021 19:05:39 PAGE 13  

 737   2                      break;
 738   2              default:break;
 739   2              }
 740   1      }
 741          
 742          //========================================================================
 743          // 描述: LCD读取ID.
 744          // 参数: none;
 745          // 返回: 读取到的ID号.
 746          //========================================================================
 747          uint16 tft_lcd_read_id()
 748          {
 749   1              uint8 val[4] = { 0 };
 750   1              tft_lcd_readreg(0xD3, val, 4);
 751   1              return (val[2] << 8) | val[3];
 752   1      }
 753          
 754          //========================================================================
 755          // 描述: LCD填充.
 756          // 参数: sx，sy:起始坐标; x1,y1:终止坐标; color:颜色
 757          // 返回: none.
 758          //========================================================================
 759          void tft_lcd_fill(uint16 x0, uint16 y0, uint16 x1, uint16 y1, uint16 color)
 760          {
 761   1              uint16 i, j;
 762   1              uint16 width = x1 - x0 + 1;             //得到填充的宽度
 763   1              uint16 height = y1 - y0 + 1;            //高度
 764   1              tft_lcd_set_windows(x0, y0, x1, y1);//设置显示窗口
 765   1              for (i = 0; i < height; i++)
 766   1              {
 767   2                      for (j = 0; j < width; j++)
 768   2                              tft_lcd_wr_data_16bit(color);   //写入数据       
 769   2              }
 770   1              tft_lcd_set_windows(0, 0, lcddev.width - 1, lcddev.height - 1);//恢复窗口设置为全屏
 771   1      }
 772          
 773          //========================================================================
 774          // 描述: LCD绘制线段.
 775          // 参数: x1，y1:起始坐标; x2,y2:终止坐标;color:颜色.
 776          // 返回: none.
 777          //========================================================================
 778          void tft_lcd_draw_line(uint16 x0, uint16 y0, uint16 x1, uint16 y1, uint16 color)
 779          {
 780   1              int t;
 781   1              int xerr = 0, yerr = 0, delta_x, delta_y, distance;
 782   1              int incx, incy, uRow, uCol;
 783   1              uint16 tem_color = _tft_lcd_point_color;
 784   1              _tft_lcd_point_color = color;
 785   1              delta_x = x1 - x0; //计算坐标增量 
 786   1              delta_y = y1 - y0;
 787   1              uRow = x0;
 788   1              uCol = y0;
 789   1              if (delta_x > 0)incx = 1; //设置单步方向 
 790   1              else if (delta_x == 0)incx = 0;//垂直线 
 791   1              else { incx = -1; delta_x = -delta_x; }
 792   1              if (delta_y > 0)incy = 1;
 793   1              else if (delta_y == 0)incy = 0;//水平线 
 794   1              else { incy = -1; delta_y = -delta_y; }
 795   1              if (delta_x > delta_y)distance = delta_x; //选取基本增量坐标轴 
 796   1              else distance = delta_y;
 797   1              for (t = 0; t <= distance + 1; t++)//画线输出 
 798   1              {
C51 COMPILER V9.60.0.0   TFTLCD                                                            01/08/2021 19:05:39 PAGE 14  

 799   2                      tft_lcd_draw_point(uRow, uCol);//画点 
 800   2                      xerr += delta_x;
 801   2                      yerr += delta_y;
 802   2                      if (xerr > distance)
 803   2                      {
 804   3                              xerr -= distance;
 805   3                              uRow += incx;
 806   3                      }
 807   2                      if (yerr > distance)
 808   2                      {
 809   3                              yerr -= distance;
 810   3                              uCol += incy;
 811   3                      }
 812   2              }
 813   1              _tft_lcd_point_color = tem_color;
 814   1      }
 815          
 816          //========================================================================
 817          // 描述: LCD绘制一条粗线.
 818          // 参数: x0，y0:起始坐标; x1,y1:终止坐标; size:线的粗细(0~2); color:颜色.
 819          // 返回: none.
 820          //========================================================================
 821          void tft_lcd_draw_line1(uint16 x0,uint16 y0,uint16 x1,uint16 y1,uint8 msize,uint16 color)
 822          {
 823   1              int t; 
 824   1              int xerr=0,yerr=0,delta_x,delta_y,distance; 
 825   1              int incx,incy,uRow,uCol; 
 826   1      
 827   1              uint16 tem_color = _tft_lcd_point_color;
 828   1              _tft_lcd_point_color = color;
 829   1      
 830   1              delta_x=x1-x0; //计算坐标增量
 831   1              delta_y=y1-y0; 
 832   1              uRow=x0; 
 833   1              uCol=y0; 
 834   1              if(delta_x>0)incx=1; //设置单步方向
 835   1              else if(delta_x==0)incx=0;//垂直线
 836   1              else {incx=-1;delta_x=-delta_x;} 
 837   1              if(delta_y>0)incy=1; 
 838   1              else if(delta_y==0)incy=0;//水平线 
 839   1              else{incy=-1;delta_y=-delta_y;} 
 840   1              if( delta_x>delta_y)distance=delta_x; //选取基本增量坐标轴
 841   1              else distance=delta_y; 
 842   1              for(t=0;t<=distance+1;t++ )//画线输出
 843   1              {  
 844   2                      if(msize==0)tft_lcd_draw_point(uRow,uCol);//画点
 845   2                      if(msize==1)
 846   2                      {
 847   3                              tft_lcd_draw_point(uRow,uCol);   
 848   3                              tft_lcd_draw_point(uRow+1,uCol);    
 849   3                              tft_lcd_draw_point(uRow,uCol+1);    
 850   3                              tft_lcd_draw_point(uRow+1,uCol+1);   
 851   3                      }
 852   2                      if(msize==2)
 853   2                      {
 854   3                              tft_lcd_draw_point(uRow,uCol);
 855   3                              tft_lcd_draw_point(uRow+1,uCol);
 856   3                              tft_lcd_draw_point(uRow,uCol+1);
 857   3                              tft_lcd_draw_point(uRow+1,uCol+1);
 858   3                              tft_lcd_draw_point(uRow-1,uCol+1);
 859   3                              tft_lcd_draw_point(uRow+1,uCol-1);
 860   3                              tft_lcd_draw_point(uRow-1,uCol-1);
C51 COMPILER V9.60.0.0   TFTLCD                                                            01/08/2021 19:05:39 PAGE 15  

 861   3                              tft_lcd_draw_point(uRow-1,uCol);
 862   3                              tft_lcd_draw_point(uRow,uCol-1);
 863   3                      }
 864   2                      xerr+=delta_x ; 
 865   2                      yerr+=delta_y ; 
 866   2                      if(xerr>distance) 
 867   2                      { 
 868   3                              xerr-=distance; 
 869   3                              uRow+=incx; 
 870   3                      } 
 871   2                      if(yerr>distance) 
 872   2                      { 
 873   3                              yerr-=distance; 
 874   3                              uCol+=incy; 
 875   3                      } 
 876   2              }
 877   1              _tft_lcd_point_color = tem_color;                                
 878   1      }
 879          
 880          //========================================================================
 881          // 描述: LCD绘制矩形框.
 882          // 参数: x0，y0:起始坐标; x1,y1:终止坐标; color:颜色;
 883          // 返回: none.
 884          //========================================================================
 885          void tft_lcd_draw_rectangle(uint16 x0, uint16 y0, uint16 x1, uint16 y1, uint16 color)
 886          {
 887   1              tft_lcd_draw_line(x0, y0, x1, y0,color);
 888   1              tft_lcd_draw_line(x0, y0, x0, y1,color);
 889   1              tft_lcd_draw_line(x0, y1, x1, y1,color);
 890   1              tft_lcd_draw_line(x1, y0, x1, y1,color);
 891   1      }
 892          
 893          //========================================================================
 894          // 描述: 在指定位置填充矩形.
 895          // 参数: x0，y0:起始坐标; x1,y1:终止坐标; color:颜色;
 896          // 返回: none.
 897          //========================================================================
 898          void tft_lcd_fill_rectangle(uint16 x0, uint16 y0, uint16 x1, uint16 y1, uint16 color)
 899          {
 900   1              tft_lcd_fill(x0, y0, x1, y1, color);
 901   1      }
 902          
 903          //========================================================================
 904          // 描述: 画点.
 905          // 参数: x，y:坐标; color:颜色值;
 906          // 返回: none.
 907          //========================================================================
 908          void tft_gui_drawpoint(uint16 x, uint16 y, uint16 color)
 909          {
 910   1              tft_lcd_set_cursor(x, y);//设置光标位置 
 911   1              tft_lcd_wr_data_16bit(color);
 912   1      }
 913          
 914          //========================================================================
 915          // 描述: 对称圆绘制算法(内部调用).
 916          // 参数: xc:圆心的x坐标; yc:圆心的y坐标; x:相对于圆心的x坐标; y:相对于圆心的y坐标; 
 917          //               color:圆圈的颜色值
 918          // 返回: none.
 919          //========================================================================
 920          void tft_draw_circle_8(int xc, int yc, int x, int y, uint16 color)
 921          {
 922   1              tft_gui_drawpoint(xc + x, yc + y, color);
C51 COMPILER V9.60.0.0   TFTLCD                                                            01/08/2021 19:05:39 PAGE 16  

 923   1      
 924   1              tft_gui_drawpoint(xc - x, yc + y, color);
 925   1      
 926   1              tft_gui_drawpoint(xc + x, yc - y, color);
 927   1      
 928   1              tft_gui_drawpoint(xc - x, yc - y, color);
 929   1      
 930   1              tft_gui_drawpoint(xc + y, yc + x, color);
 931   1      
 932   1              tft_gui_drawpoint(xc - y, yc + x, color);
 933   1      
 934   1              tft_gui_drawpoint(xc + y, yc - x, color);
 935   1      
 936   1              tft_gui_drawpoint(xc - y, yc - x, color);
 937   1      }
 938          
 939          //========================================================================
 940          // 描述: 在指定位置绘制指定大小的圆.
 941          // 参数: xc:圆心的x坐标; yc:圆心的y坐标; color:圆的颜色; r:圆半径; fill:1-填充，0-不填充;
 942          // 返回: none.
 943          //========================================================================
 944          void tft_lcd_draw_circle(int xc, int yc, int r, uint16 color, uint8 fill)
 945          {
 946   1              int x = 0, y = r, yi, d;
 947   1      
 948   1              d = 3 - 2 * r;
 949   1      
 950   1              if (fill)
 951   1              {
 952   2                      // 如果填充（画实心圆）
 953   2                      while (x <= y) {
 954   3                              for (yi = x; yi <= y; yi++)
 955   3                                      tft_draw_circle_8(xc, yc, x, yi, color);
 956   3      
 957   3                              if (d < 0) {
 958   4                                      d = d + 4 * x + 6;
 959   4                              }
 960   3                              else {
 961   4                                      d = d + 4 * (x - y) + 10;
 962   4                                      y--;
 963   4                              }
 964   3                              x++;
 965   3                      }
 966   2              }
 967   1              else
 968   1              {
 969   2                      // 如果不填充（画空心圆）
 970   2                      while (x <= y) {
 971   3                              tft_draw_circle_8(xc, yc, x, y, color);
 972   3                              if (d < 0) {
 973   4                                      d = d + 4 * x + 6;
 974   4                              }
 975   3                              else {
 976   4                                      d = d + 4 * (x - y) + 10;
 977   4                                      y--;
 978   4                              }
 979   3                              x++;
 980   3                      }
 981   2              }
 982   1      }
 983          
 984          //========================================================================
C51 COMPILER V9.60.0.0   TFTLCD                                                            01/08/2021 19:05:39 PAGE 17  

 985          // 描述: 在指定位置绘制一个三角形.
 986          // 参数: x0,y0,x1,y1,x2,y2:三角形三个端点的坐标; color:颜色
 987          // 返回: none.
 988          //========================================================================
 989          void tft_lcd_draw_triangel(uint16 x0, uint16 y0, uint16 x1, uint16 y1, uint16 x2, uint16 y2, uint16 color)
 990          {
 991   1              tft_lcd_draw_line(x0, y0, x1, y1,color);
 992   1              tft_lcd_draw_line(x1, y1, x2, y2,color);
 993   1              tft_lcd_draw_line(x2, y2, x0, y0,color);
 994   1      }
 995          
 996          //========================================================================
 997          // 描述: 交换函数（内部调用）.
 998          // 参数: a,b:要交换的值的指针.
 999          // 返回: none.
1000          //========================================================================
1001          static void tft_swap(uint16* a, uint16* b)
1002          {
1003   1              uint16 tmp;
1004   1              tmp = *a;
1005   1              *a = *b;
1006   1              *b = tmp;
1007   1      }
1008          
1009          //========================================================================
1010          // 描述: 在指定位置填充三角形.
1011          // 参数: x0,y0,x1,y1,x2,y2:三角形三个端点的坐标; color:颜色.
1012          // 返回: none.
1013          //========================================================================
1014          void tft_lcd_fill_triangel(uint16 x0, uint16 y0, uint16 x1, uint16 y1, uint16 x2, uint16 y2, uint16 color)
1015          {
1016   1              uint16 a, b, y, last;
1017   1              int dx01, dy01, dx02, dy02, dx12, dy12;
1018   1              long sa = 0;
1019   1              long sb = 0;
1020   1              if (y0 > y1)
1021   1              {
1022   2                      tft_swap(&y0, &y1);
1023   2                      tft_swap(&x0, &x1);
1024   2              }
1025   1              if (y1 > y2)
1026   1              {
1027   2                      tft_swap(&y2, &y1);
1028   2                      tft_swap(&x2, &x1);
1029   2              }
1030   1              if (y0 > y1)
1031   1              {
1032   2                      tft_swap(&y0, &y1);
1033   2                      tft_swap(&x0, &x1);
1034   2              }
1035   1              if (y0 == y2)
1036   1              {
1037   2                      a = b = x0;
1038   2                      if (x1 < a)
1039   2                      {
1040   3                              a = x1;
1041   3                      }
1042   2                      else if (x1 > b)
1043   2                      {
1044   3                              b = x1;
1045   3                      }
1046   2                      if (x2 < a)
C51 COMPILER V9.60.0.0   TFTLCD                                                            01/08/2021 19:05:39 PAGE 18  

1047   2                      {
1048   3                              a = x2;
1049   3                      }
1050   2                      else if (x2 > b)
1051   2                      {
1052   3                              b = x2;
1053   3                      }
1054   2                      tft_lcd_fill(a, y0, b, y0, color);
1055   2                      return;
1056   2              }
1057   1              dx01 = x1 - x0;
1058   1              dy01 = y1 - y0;
1059   1              dx02 = x2 - x0;
1060   1              dy02 = y2 - y0;
1061   1              dx12 = x2 - x1;
1062   1              dy12 = y2 - y1;
1063   1      
1064   1              if (y1 == y2)
1065   1              {
1066   2                      last = y1;
1067   2              }
1068   1              else
1069   1              {
1070   2                      last = y1 - 1;
1071   2              }
1072   1              for (y = y0; y <= last; y++)
1073   1              {
1074   2                      a = x0 + sa / dy01;
1075   2                      b = x0 + sb / dy02;
1076   2                      sa += dx01;
1077   2                      sb += dx02;
1078   2                      if (a > b)
1079   2                      {
1080   3                              tft_swap(&a, &b);
1081   3                      }
1082   2                      tft_lcd_fill(a, y, b, y, color);
1083   2              }
1084   1              sa = dx12 * (y - y1);
1085   1              sb = dx02 * (y - y0);
1086   1              for (; y <= y2; y++)
1087   1              {
1088   2                      a = x1 + sa / dy12;
1089   2                      b = x0 + sb / dy02;
1090   2                      sa += dx12;
1091   2                      sb += dx02;
1092   2                      if (a > b)
1093   2                      {
1094   3                              tft_swap(&a, &b);
1095   3                      }
1096   2                      tft_lcd_fill(a, y, b, y, color);
1097   2              }
1098   1      }
1099          
1100          //========================================================================
1101          // 描述: 在指定位置显示一个字符.
1102          // 参数: x:起始x坐标; y:起始y坐标; chr:显示的字符; font_color:显示字符的颜色值; 
1103          //       background_color:显示字符的背景色; size:显示字符的大小; mode:0-无叠加，1-叠加:   
1104          // 返回: none.
1105          //========================================================================
1106          void tft_lcd_show_char(int16 x,int16 y, uint8 chr, uint16 font_color, uint16 background_color, uint8 msize
             -,uint8 mode)
1107          {  
C51 COMPILER V9.60.0.0   TFTLCD                                                            01/08/2021 19:05:39 PAGE 19  

1108   1              uint8 temp;
1109   1              uint8 j,i;
1110   1              chr=chr-' ';                                              //得到偏移后的值
1111   1              if(x < 0)
1112   1              {
1113   2                      for(j=0;j<msize;j++)
1114   2                      {
1115   3                              if(msize==12)temp=asc2_1206[chr][j]; //调用1206字体
1116   3                              else temp=asc2_1608[chr][j];            //调用1608字体 
1117   3                              for(i=0;i<msize/2;i++)
1118   3                          {   
1119   4                                      if(((x + i) >= 0))
1120   4                                      {   
1121   5                                              if(!mode) //非叠加方式
1122   5                                              {
1123   6                                                      if(temp&0x01){
1124   7                                                              tft_lcd_set_cursor(x+i,y+j);
1125   7                                                              tft_lcd_wr_data_16bit(font_color);
1126   7                                                      }
1127   6                                                      else{
1128   7                                                              tft_lcd_set_cursor(x+i,y+j);
1129   7                                                              tft_lcd_wr_data_16bit(background_color); 
1130   7                                                      }
1131   6                                              }
1132   5                                              else
1133   5                                              {            
1134   6                                                      if(temp&0x01){
1135   7                                                              tft_lcd_set_cursor(x+i,y+j);//画一个点 
1136   7                                                              tft_lcd_wr_data_16bit(font_color);      
1137   7                                                      }
1138   6                                              }
1139   5                                      }
1140   4                                      temp>>=1; 
1141   4                          }
1142   3                      }       
1143   2              }
1144   1              else{
1145   2                      for(j=0;j<msize;j++)
1146   2                      {
1147   3                              if(msize==12)temp=asc2_1206[chr][j]; //调用1206字体
1148   3                              else temp=asc2_1608[chr][j];            //调用1608字体 
1149   3                              for(i=0;i<msize/2;i++)
1150   3                          {      
1151   4                                      if(!mode) //非叠加方式
1152   4                                      {
1153   5                                              if(temp&0x01){
1154   6                                                      tft_lcd_set_cursor(x+i,y+j);
1155   6                                                      tft_lcd_wr_data_16bit(font_color);
1156   6                                              }
1157   5                                              else{
1158   6                                                      tft_lcd_set_cursor(x+i,y+j);
1159   6                                                      tft_lcd_wr_data_16bit(background_color); 
1160   6                                              }
1161   5                                      }
1162   4                                      else
1163   4                                      {            
1164   5                                              if(temp&0x01){
1165   6                                                      tft_lcd_set_cursor(x+i,y+j);//画一个点 
1166   6                                                      tft_lcd_wr_data_16bit(font_color);      
1167   6                                              }
1168   5                                      }
1169   4                                      temp>>=1; 
C51 COMPILER V9.60.0.0   TFTLCD                                                            01/08/2021 19:05:39 PAGE 20  

1170   4                          }
1171   3                      }       
1172   2              }
1173   1              tft_lcd_set_windows(0,0,lcddev.width-1,lcddev.height-1);//恢复窗口为全屏                          
1174   1      }
1175          
1176          //========================================================================
1177          // 描述: 在指定位置显示字符串.
1178          // 参数: x:起始x坐标; y:起始y坐标; p:要显示的字符串; font_color:字符串的颜色值; background_color:背景色
1179          //       size:显示字符的大小（12或16）;  mode:0-无叠加，1-叠加.
1180          // 返回: none.
1181          //========================================================================
1182          void tft_lcd_show_string(int16 x,int16 y,uint8 *p,uint16 font_color, uint16 background_color,uint8 msize,u
             -int8 mode)
1183          {            
1184   1          while((*p<='~')&&(*p>=' '))         //判断是不是非法字符    
1185   1          {       
1186   2              tft_lcd_show_char(x,y,*p,font_color,background_color,msize,mode);
1187   2              x+=msize/2;
1188   2              p++;
1189   2          }  
1190   1      } 
1191          
1192          //========================================================================
1193          // 描述: 获得m的n次幂.
1194          // 参数: m,n:
1195          // 返回: none.
1196          //========================================================================
1197          // uint32 tft_mypow(uint8 m,uint8 n)
1198          // {
1199          //      uint32 result=1;         
1200          //      while(n--)result*=m;    
1201          //      return result;
1202          // }
1203          
1204          //========================================================================
1205          // 描述: 在指定位置显示数字.
1206          // 参数: x:三角形边的起始x坐标; y:三角形边的起始y坐标; num:要显示的数字(0~4294967295);
1207          //       len:长度; font_color:字符串的颜色值; background_color:背景色; size:显示的大小 mode:0-无叠加，1-叠
             -加.
1208          // 返回: none.
1209          //========================================================================
1210          // void tft_lcd_show_num(uint16 x,uint16 y,uint32 num,uint8 len,uint16 font_color, uint16 background_color
             -,uint8 size, uint8 mode)
1211          // {            
1212          //      uint8 t,temp;
1213          //      uint8 enshow=0;                                            
1214          //      for(t=0;t<len;t++)
1215          //      {
1216          //              temp=(num/tft_mypow(10,len-t-1))%10;
1217          //              if(enshow==0&&t<(len-1))
1218          //              {
1219          //                      if(temp==0)
1220          //                      {
1221          //                              tft_lcd_show_char(x+(size/2)*t,y,' ',font_color,background_color,size,mode);
1222          //                              continue;
1223          //                      }else enshow=1;  
1224          //              }
1225          //              tft_lcd_show_char(x+(size/2)*t,y,temp+'0',font_color,background_color,size,mode); 
1226          //      }
1227          // }
1228          
C51 COMPILER V9.60.0.0   TFTLCD                                                            01/08/2021 19:05:39 PAGE 21  

1229          //========================================================================
1230          // 描述: 在指定位置显示数字.
1231          // 参数: x:三角形边的起始x坐标; y:三角形边的起始y坐标; num:要显示的数字(0~4294967295);
1232          //       len:长度; font_color:字符串的颜色值; background_color:背景色; size:显示的大小 mode:0-无叠加，1-叠
             -加.
1233          // 返回: none.
1234          //========================================================================
1235          void tft_lcd_show_num(int16 x, int16 y, int num, uint16 font_color, uint16 background_color, uint8 msize, 
             -uint8 mode)
1236          {
1237   1              char men[10];
1238   1          sprintf(men,"%d",num);
1239   1              //_itoa(num,men,10);
1240   1              tft_lcd_show_string(x,y,men,font_color,background_color,msize,mode);
1241   1      } 
1242          
1243          //========================================================================
1244          // 描述: 在指定位置显示12*12字体汉字.
1245          // 参数: hz:汉字的指针; x:起始x坐标; y:起始y坐标; lenth: 字体的总长度 
1246          //       font_color:显示字符的颜色值; background_color:显示字符的背景色;mode:0-无叠加，1-叠加.
1247          // 返回: none.
1248          //========================================================================
1249          void tft_lcd_show_font12(uint8 lenth, uint8 *hz, int16 x, int16 y,uint16 font_color, uint16 background_col
             -or, uint8 mode)
1250          {
1251   1              uint8 zz,i,j;
1252   1              int16 zs;
1253   1              if(x < 0)
1254   1              {
1255   2                      zs = (0-x) / 12;        
1256   2                      for(zz = zs; zz < lenth; zz++)          //要显示的字体循环
1257   2                      {
1258   3                              for(i = 0;i < 12;i++)
1259   3                              {
1260   4                                      for(j = 0;j < 12;j++)
1261   4                                      {
1262   5                                              if((zz * 12 + j + x -12) > 239)return;
1263   5                                              if((y + i -12) > 339)return;
1264   5                                              if (!((zz * 12 + x + j) < 0)){
1265   6                                                      if(!mode)               //无叠加
1266   6                                                      {
1267   7                                                              if(hz[zz*24 + i * 2 + j/8] & (0x80 >> (j % 8))){
1268   8                                                                      tft_lcd_set_cursor(zz * 12+ x + j,y + i);
1269   8                                                                      tft_lcd_wr_data_16bit(font_color);
1270   8                                                              }
1271   7                                                              else{
1272   8                                                                      tft_lcd_set_cursor(zz * 12+ x + j,y + i);
1273   8                                                                      tft_lcd_wr_data_16bit(background_color);
1274   8                                                              } 
1275   7                                                      }
1276   6                                                      else
1277   6                                                      {
1278   7                                                              if(hz[zz*24 + i * 2 + j/8] & (0x80>>(j % 8))){
1279   8                                                                      tft_lcd_set_cursor(zz * 12+ x + j,y + i);
1280   8                                                                      tft_lcd_wr_data_16bit(font_color);
1281   8                                                              }
1282   7                                                      }
1283   6                                              }
1284   5                                      }
1285   4                              }
1286   3                      }
1287   2              }
C51 COMPILER V9.60.0.0   TFTLCD                                                            01/08/2021 19:05:39 PAGE 22  

1288   1              else
1289   1              {
1290   2                      for(zz = 0; zz < lenth; zz++)           //要显示的字体循环
1291   2                      {
1292   3                              
1293   3                              for(i = 0;i < 12;i++)
1294   3                              {
1295   4                                      for(j = 0;j < 12;j++)
1296   4                                      {
1297   5                                              if((zz * 12 + j + x -12) > 239)return;
1298   5                                              if((y + i -12) > 339)return;
1299   5                                              if(!mode)               //无叠加
1300   5                                              {
1301   6                                                      if(hz[zz*24 + i * 2 + j/8] & (0x80 >> (j % 8))){
1302   7                                                              tft_lcd_set_cursor(zz * 12+ x + j,y + i);
1303   7                                                              tft_lcd_wr_data_16bit(font_color);
1304   7                                                      }
1305   6                                                      else{
1306   7                                                              tft_lcd_set_cursor(zz * 12+ x + j,y + i);
1307   7                                                              tft_lcd_wr_data_16bit(background_color);
1308   7                                                      }
1309   6                                              }
1310   5                                              else
1311   5                                              {
1312   6                                                      if(hz[zz*24 + i * 2 + j/8] & (0x80>>(j % 8))){
1313   7                                                              tft_lcd_set_cursor(zz * 12+ x + j,y + i);
1314   7                                                              tft_lcd_wr_data_16bit(font_color);                                              
1315   7                                                      }
1316   6                                              }
1317   5                                      }
1318   4                              }
1319   3                      }
1320   2              }
1321   1              tft_lcd_set_windows(0,0,lcddev.width-1,lcddev.height-1);//恢复窗口为全屏
1322   1      }
1323          
1324          //========================================================================
1325          // 描述: 在指定位置显示16*16字体汉字.
1326          // 参数: hz:汉字的指针; x:起始x坐标; y:起始y坐标; lenth: 字体的总长度 
1327          //       font_color:显示字符的颜色值; background_color:显示字符的背景色;mode:0-无叠加，1-叠加.
1328          // 返回: none.
1329          //========================================================================
1330          void tft_lcd_show_font16(uint8 lenth, uint8 *hz, int16 x, int16 y,uint16 font_color, uint16 background_col
             -or, uint8 mode)
1331          {
1332   1              uint8 zz,i,j;
1333   1              int16 zs;
1334   1              if(x < 0)
1335   1              {
1336   2                      zs = (0-x) / 16;        
1337   2                      for(zz = zs; zz < lenth; zz++)          //要显示的字体循环
1338   2                      {
1339   3                              for(i = 0;i < 16;i++)
1340   3                              {
1341   4                                      for(j = 0;j < 16;j++)
1342   4                                      {
1343   5                                              if((zz * 16 + j + x -16) > 239)return;
1344   5                                              if((y + i -16) > 339)return;
1345   5                                              if (!((zz * 16 + x + j) < 0)){
1346   6                                                      if(!mode)               //无叠加
1347   6                                                      {
1348   7                                                              if(hz[zz*32+i * 2 + j/8] & (0x80 >> (j % 8))){
C51 COMPILER V9.60.0.0   TFTLCD                                                            01/08/2021 19:05:39 PAGE 23  

1349   8                                                                      tft_lcd_set_cursor(zz * 16+ x + j,y + i);
1350   8                                                                      tft_lcd_wr_data_16bit(font_color);
1351   8                                                              }
1352   7                                                              else{
1353   8                                                                      tft_lcd_set_cursor(zz * 16+ x + j,y + i);
1354   8                                                                      tft_lcd_wr_data_16bit(background_color);
1355   8                                                              }
1356   7                                                      }
1357   6                                                      else
1358   6                                                      {
1359   7                                                              if(hz[zz*32 + i * 2 + j/8] & (0x80>>(j % 8))){
1360   8                                                                      tft_lcd_set_cursor(zz * 16+ x + j,y + i);
1361   8                                                                      tft_lcd_wr_data_16bit(font_color);                                                      
1362   8                                                              }
1363   7                                                      }
1364   6                                              }
1365   5                                      }
1366   4                              }
1367   3                      }
1368   2              }
1369   1              else
1370   1              {
1371   2                      for(zz = 0; zz < lenth; zz++)           //要显示的字体循环
1372   2                      {
1373   3                              for(i = 0;i < 16;i++)
1374   3                              {
1375   4                                      for(j = 0;j < 16;j++)
1376   4                                      {
1377   5                                              if((zz * 16 + j + x -16) > 239)return;
1378   5                                              if((y + i -16) > 339)return;
1379   5      
1380   5                                              if(!mode)               //无叠加
1381   5                                              {
1382   6                                                      if(hz[zz*32+i * 2 + j/8] & (0x80 >> (j % 8))){
1383   7                                                              tft_lcd_set_cursor(zz * 16+ x + j,y + i);
1384   7                                                              tft_lcd_wr_data_16bit(font_color);
1385   7                                                      }
1386   6                                                      else{
1387   7                                                              tft_lcd_set_cursor(zz * 16+ x + j,y + i);
1388   7                                                              tft_lcd_wr_data_16bit(background_color);
1389   7                                                      }
1390   6                                              }
1391   5                                              else
1392   5                                              {
1393   6                                                      if(hz[zz*32 + i * 2 + j/8] & (0x80>>(j % 8))){
1394   7                                                              tft_lcd_set_cursor(zz * 16+ x + j,y + i);
1395   7                                                              tft_lcd_wr_data_16bit(font_color);
1396   7                                                      }
1397   6                                              }
1398   5                                      }
1399   4                              }
1400   3                      }
1401   2              }
1402   1              tft_lcd_set_windows(0,0,lcddev.width-1,lcddev.height-1);//恢复窗口为全屏
1403   1      }
1404          //========================================================================
1405          // 描述: 在指定位置显示24*24字体汉字.
1406          // 参数: hz:汉字的指针; x:起始x坐标; y:起始y坐标; lenth: 字体的总长度 
1407          //       font_color:显示字符的颜色值; background_color:显示字符的背景色;mode:0-无叠加，1-叠加.
1408          // 返回: none.
1409          //========================================================================
1410          void tft_lcd_show_font24(uint8 lenth, uint8 *hz, int16 x, int16 y,uint16 font_color, uint16 background_col
C51 COMPILER V9.60.0.0   TFTLCD                                                            01/08/2021 19:05:39 PAGE 24  

             -or, uint8 mode)
1411          {
1412   1              uint8 zz,i,j;
1413   1              int16 zs;
1414   1              if(x < 0)
1415   1              {
1416   2                      zs = (0-x) / 24;        
1417   2                      for(zz = zs; zz < lenth; zz++)          //要显示的字体循环
1418   2                      {
1419   3                              for(i = 0;i < 24;i++)
1420   3                              {
1421   4                                      for(j = 0;j < 24;j++)
1422   4                                      {
1423   5                                              if((zz * 24 + j + x -24) > 239)return;
1424   5                                              if((y + i -24) > 339)return;
1425   5                                              if (!((zz * 24 + x + j) < 0))
1426   5                                              {
1427   6                                                      if(!mode)               //无叠加
1428   6                                                      {
1429   7                                                              if(hz[zz*72+i * 3 + j/8] & (0x80 >> (j % 8))){
1430   8                                                                      tft_lcd_set_cursor(zz * 24+ x + j,y + i);
1431   8                                                                      tft_lcd_wr_data_16bit(font_color);
1432   8                                                              }
1433   7                                                              else {
1434   8                                                                      tft_lcd_set_cursor(zz * 24+ x + j,y + i);
1435   8                                                                      tft_lcd_wr_data_16bit(background_color);
1436   8                                                              }
1437   7                                                      }
1438   6                                                      else
1439   6                                                      {
1440   7                                                              if(hz[zz*72 + i * 3 + j/8] & (0x80>>(j % 8))){
1441   8                                                                      tft_lcd_set_cursor(zz * 24+ x + j,y + i);
1442   8                                                                      tft_lcd_wr_data_16bit(font_color);      
1443   8                                                              }
1444   7                                                      }
1445   6                                              }
1446   5                                      }
1447   4                              }
1448   3                      }
1449   2              }
1450   1              else
1451   1              {
1452   2                      for(zz = 0; zz < lenth; zz++)           //要显示的字体循环
1453   2                      {
1454   3                              for(i = 0;i < 24;i++)
1455   3                              {
1456   4                                      for(j = 0;j < 24;j++)
1457   4                                      {
1458   5                                              if((zz * 24 + j + x -24) > 239)return;
1459   5                                              if((y + i -24) > 339)return;
1460   5      
1461   5                                              if(!mode)               //无叠加
1462   5                                              {
1463   6                                                      if(hz[zz*72+i * 3 + j/8] & (0x80 >> (j % 8))){
1464   7                                                              tft_lcd_set_cursor(zz * 24+ x + j,y + i);
1465   7                                                              tft_lcd_wr_data_16bit(font_color);
1466   7                                                      }
1467   6                                                      else{
1468   7                                                              tft_lcd_set_cursor(zz * 24+ x + j,y + i);
1469   7                                                              tft_lcd_wr_data_16bit(background_color);
1470   7                                                      }
1471   6                                              }
C51 COMPILER V9.60.0.0   TFTLCD                                                            01/08/2021 19:05:39 PAGE 25  

1472   5                                              else
1473   5                                              {
1474   6                                                      if(hz[zz*72 + i * 3 + j/8] & (0x80>>(j % 8))){
1475   7                                                              tft_lcd_set_cursor(zz * 24+ x + j,y + i);
1476   7                                                              tft_lcd_wr_data_16bit(font_color);      
1477   7                                                      }
1478   6                                              }
1479   5                                      }
1480   4                              }
1481   3                      }
1482   2              }
1483   1              tft_lcd_set_windows(0,0,lcddev.width-1,lcddev.height-1);//恢复窗口为全屏
1484   1      }
1485          //========================================================================
1486          // 描述: 在指定位置显示32*32字体汉字.
1487          // 参数: hz:汉字的指针; x:起始x坐标; y:起始y坐标; lenth: 字体的总长度 
1488          //       font_color:显示字符的颜色值; background_color:显示字符的背景色;mode:0-无叠加，1-叠加.
1489          // 返回: none.
1490          //========================================================================
1491          void tft_lcd_show_font32(uint8 lenth, uint8 *hz, int16 x, int16 y,uint16 font_color, uint16 background_col
             -or, uint8 mode)
1492          {
1493   1              uint8 zz,i,j;
1494   1              int16 zs;
1495   1              if(x < 0)
1496   1              {
1497   2                      zs = (0-x) / 32;        
1498   2                      for(zz = zs; zz < lenth; zz++)          //要显示的字体循环
1499   2                      {
1500   3                              for(i = 0;i < 32;i++)
1501   3                              {
1502   4                                      for(j = 0;j < 32;j++)
1503   4                                      {
1504   5                                              if((zz * 34 + j + x -34) > 239)return;
1505   5                                              if((y + i -34) > 339)return;
1506   5                                              if (!((zz * 34 + x + j) < 0)){
1507   6                                                      if(!mode)               //无叠加
1508   6                                                      {
1509   7                                                              if (hz[zz * 128 + i * 4 + j/ 8] & (0x80 >> (j % 8))){
1510   8                                                                      tft_lcd_set_cursor(zz * 32+ x + j,y + i);
1511   8                                                                      tft_lcd_wr_data_16bit(font_color);
1512   8                                                              }
1513   7                                                              else{ 
1514   8                                                                      tft_lcd_set_cursor(zz * 32+ x + j,y + i);
1515   8                                                                      tft_lcd_wr_data_16bit(background_color);
1516   8                                                              }
1517   7                                                      }
1518   6                                                      else
1519   6                                                      {
1520   7                                                              if (hz[zz * 128 + i * 4 + j/ 8] & (0x80 >> (j % 8))){
1521   8                                                                      tft_lcd_set_cursor(zz * 32+ x + j,y + i);
1522   8                                                                      tft_lcd_wr_data_16bit(font_color);
1523   8                                                              }
1524   7                                                      }
1525   6                                              }
1526   5                                      }
1527   4                              }
1528   3                      }
1529   2              }
1530   1              else
1531   1              {
1532   2                      for(zz = 0; zz < lenth; zz++)           //要显示的字体循环
C51 COMPILER V9.60.0.0   TFTLCD                                                            01/08/2021 19:05:39 PAGE 26  

1533   2                      {
1534   3                              tft_lcd_set_windows(x+32*zz,y,x+32*zz+32-1,y+32-1);
1535   3                              for(i = 0;i < 32;i++)
1536   3                              {
1537   4                                      for(j = 0;j < 32;j++)
1538   4                                      {
1539   5                                              if((zz * 32 + j + x -32) > 239)return;
1540   5                                              if((y + i -32) > 339)return;
1541   5      
1542   5                                              if(!mode)               //无叠加
1543   5                                              {
1544   6                                                      if (hz[zz * 128 + i * 4 + j/ 8] & (0x80 >> (j % 8))){
1545   7                                                              tft_lcd_set_cursor(zz * 32+ x + j,y + i);
1546   7                                                              tft_lcd_wr_data_16bit(font_color);
1547   7                                                      }
1548   6                                                      else{
1549   7                                                              tft_lcd_set_cursor(zz * 32+ x + j,y + i);
1550   7                                                              tft_lcd_wr_data_16bit(background_color);
1551   7                                                      }
1552   6                                              }
1553   5                                              else
1554   5                                              {
1555   6                                                      if (hz[zz * 128 + i * 4 + j/ 8] & (0x80 >> (j % 8))){
1556   7                                                              tft_lcd_set_cursor(zz * 32+ x + j,y + i);
1557   7                                                              tft_lcd_wr_data_16bit(font_color);
1558   7                                                      }
1559   6                                              }
1560   5                                      }
1561   4                              }
1562   3                      }
1563   2              }
1564   1              tft_lcd_set_windows(0,0,lcddev.width-1,lcddev.height-1);//恢复窗口为全屏
1565   1      }
1566          
1567          //========================================================================
1568          // 描述: 显示16位的BMP图像.
1569          // 参数: x0:起始x坐标; y0:起始y坐标;w:图片的宽度; h:图片的高度; p:图像数组的起始地址
1570          // 返回: none.
1571          //========================================================================
1572          void tft_lcd_draw_bmp16(uint16 x,uint16 y,uint16 w,uint16 h,const uint8 *p)
1573          {
1574   1              int i; 
1575   1              uint8 picH,picL; 
1576   1              tft_lcd_set_windows(x,y,x+w-1,y+h-1);                           //窗口设置
1577   1          for(i=0;i<40*40;i++)
1578   1              {       
1579   2                      picL=*(p+i*2);          //数据低位在前
1580   2                      picH=*(p+i*2+1);                                
1581   2                      tft_lcd_wr_data_16bit(picH<<8|picL);                                            
1582   2              }       
1583   1              tft_lcd_set_windows(0,0,lcddev.width-1,lcddev.height-1);//恢复显示窗口为全屏
1584   1      }


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =  11478    ----
   CONSTANT SIZE    =   2667    ----
   XDATA SIZE       =     19     346
   PDATA SIZE       =   ----    ----
   DATA SIZE        =   ----    ----
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
C51 COMPILER V9.60.0.0   TFTLCD                                                            01/08/2021 19:05:39 PAGE 27  

END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
